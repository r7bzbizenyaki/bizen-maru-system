<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‚™å‰ä¸¸ å†…è¦§ä¼š ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 16px;
            padding: 24px 32px;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .badge {
            background: #27ae60;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .header h1 {
            color: #1e3c72;
            font-size: 24px;
        }

        .last-update {
            color: #666;
            font-size: 13px;
        }

        .refresh-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .refresh-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            color: #1e3c72;
        }

        .table-container {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .table-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e3c72;
        }

        .search-box {
            padding: 8px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            width: 250px;
        }

        .search-box:focus {
            outline: none;
            border-color: #3498db;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f5f7fa;
        }

        th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #333;
            font-size: 14px;
            border-bottom: 2px solid #e0e0e0;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            color: #555;
        }

        tbody tr:hover {
            background: #f5f8ff;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-reserved {
            background: #e3f2fd;
            color: #1976d2;
        }

        .status-boarded {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status-disembarked {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 16px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .search-box {
                width: 100%;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="header">
            <div class="header-left">
                <div class="badge">ğŸ›ï¸ å¸‚æ°‘é™å®š</div>
                <div>
                    <h1>ğŸš¢ å‚™å‰ä¸¸ å†…è¦§ä¼š ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
                    <div class="last-update" id="lastUpdate">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ äºˆç´„çŠ¶æ³</div>
                </div>
            </div>
            <button class="refresh-btn" onclick="loadDashboard()">ğŸ”„ åŒæœŸä¸­</button>
        </div>

        <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-label">ç·äºˆç´„æ•°</div>
                <div class="stat-value" id="totalCount">0</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">âœ…</div>
                <div class="stat-label">ä¹—èˆ¹æ¸ˆã¿</div>
                <div class="stat-value" id="boardedCount">0</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸš¢</div>
                <div class="stat-label">ç¾åœ¨ä¹—èˆ¹ä¸­</div>
                <div class="stat-value" id="onboardCount">-</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸ </div>
                <div class="stat-label">ä¸‹èˆ¹æ¸ˆã¿</div>
                <div class="stat-value" id="disembarkedCount">0</div>
            </div>
        </div>

        <!-- äºˆç´„ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ« -->
        <div class="table-container">
            <div class="table-header">
                <div class="table-title">ğŸ“‹ äºˆç´„ä¸€è¦§</div>
                <input type="text" class="search-box" id="searchBox" placeholder="ğŸ” æ¤œç´¢ï¼ˆæ°åã€ãƒã‚±ãƒƒãƒˆIDï¼‰">
            </div>

            <table>
                <thead>
                    <tr>
                        <th>ãƒã‚±ãƒƒãƒˆID</th>
                        <th>æ°å</th>
                        <th>æ—¥ä»˜</th>
                        <th>æ™‚é–“å¸¯</th>
                        <th>é›»è©±ç•ªå·</th>
                        <th>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
                        <th>äºˆç´„æ—¥æ™‚</th>
                        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr>
                        <td colspan="8" class="no-data">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // åˆæœŸåŒ–
        function init() {
            console.log('ğŸš€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åˆæœŸåŒ–');
            loadDashboard();
            setupSearch();
            
            // è‡ªå‹•æ›´æ–°ï¼ˆ10ç§’ã”ã¨ï¼‰
            setInterval(loadDashboard, 10000);
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èª­ã¿è¾¼ã¿
        function loadDashboard() {
            console.log('ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èª­ã¿è¾¼ã¿é–‹å§‹');
            updateStats();
            updateTable();
            updateLastUpdate();
            console.log('âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èª­ã¿è¾¼ã¿å®Œäº†');
        }

        // çµ±è¨ˆæ›´æ–°
        function updateStats() {
            console.log('ğŸ“Š çµ±è¨ˆæ›´æ–°é–‹å§‹');
            
            const entries = JSON.parse(localStorage.getItem('citizenEntries') || '[]');
            console.log('ğŸ“‹ å…¨ã‚¨ãƒ³ãƒˆãƒªãƒ¼æ•°:', entries.length);
            console.log('ğŸ“¦ å…¨ãƒ‡ãƒ¼ã‚¿:', entries);
            
            const total = entries.length;
            const boarded = entries.filter(e => e.boardedAt).length;
            const disembarked = entries.filter(e => e.disembarkedAt).length;
            const onboard = entries.filter(e => e.boardedAt && !e.disembarkedAt).length;
            
            console.log('ğŸ“Š çµ±è¨ˆ:', {
                total: total,
                boarded: boarded,
                disembarked: disembarked,
                onboard: onboard
            });
            
            // çµ±è¨ˆã‚«ãƒ¼ãƒ‰æ›´æ–°
            const totalElem = document.getElementById('totalCount');
            const boardedElem = document.getElementById('boardedCount');
            const onboardElem = document.getElementById('onboardCount');
            const disembarkedElem = document.getElementById('disembarkedCount');
            
            if (totalElem) totalElem.textContent = total;
            if (boardedElem) boardedElem.textContent = boarded;
            if (onboardElem) onboardElem.textContent = onboard;
            if (disembarkedElem) disembarkedElem.textContent = disembarked;
            
            console.log('âœ… çµ±è¨ˆæ›´æ–°å®Œäº†');
        }

        // ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
        function updateTable() {
            const entries = JSON.parse(localStorage.getItem('citizenEntries') || '[]');
            const tbody = document.getElementById('tableBody');
            
            if (entries.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="no-data">äºˆç´„ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }

            // æ—¥ä»˜ã®æ–°ã—ã„é †ã«ã‚½ãƒ¼ãƒˆ
            entries.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            tbody.innerHTML = entries.map(entry => {
                const status = getStatus(entry);
                const statusClass = getStatusClass(status);
                const date = formatDate(entry.date);
                const timestamp = formatTimestamp(entry.timestamp);

                return `
                    <tr>
                        <td><strong>${entry.id}</strong></td>
                        <td>${entry.name}</td>
                        <td>${date}</td>
                        <td>${entry.timeslot}</td>
                        <td>${entry.phone}</td>
                        <td>${entry.email}</td>
                        <td>${timestamp}</td>
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                    </tr>
                `;
            }).join('');
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—
        function getStatus(entry) {
            if (entry.disembarkedAt) {
                return 'ä¸‹èˆ¹æ¸ˆã¿ ğŸ ';
            } else if (entry.boardedAt) {
                return 'ä¹—èˆ¹ä¸­ ğŸš¢';
            } else {
                return 'äºˆç´„æ¸ˆã¿ ğŸ“';
            }
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¯ãƒ©ã‚¹å–å¾—
        function getStatusClass(status) {
            if (status.includes('ä¸‹èˆ¹æ¸ˆã¿')) return 'status-disembarked';
            if (status.includes('ä¹—èˆ¹ä¸­')) return 'status-boarded';
            return 'status-reserved';
        }

        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatDate(dateStr) {
            const dateMap = {
                '2026-02-27': '2æœˆ27æ—¥ï¼ˆé‡‘ï¼‰',
                '2026-03-27': '3æœˆ27æ—¥ï¼ˆé‡‘ï¼‰',
                '2026-03-28': '3æœˆ28æ—¥ï¼ˆåœŸï¼‰'
            };
            return dateMap[dateStr] || dateStr;
        }

        // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatTimestamp(timestamp) {
            const date = new Date(timestamp);
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${month}/${day} ${hours}:${minutes}`;
        }

        // æœ€çµ‚æ›´æ–°æ™‚åˆ»
        function updateLastUpdate() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('lastUpdate').textContent = `ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ äºˆç´„çŠ¶æ³ | æœ€çµ‚æ›´æ–°: ${hours}:${minutes}:${seconds}`;
        }

        // æ¤œç´¢æ©Ÿèƒ½
        function setupSearch() {
            const searchBox = document.getElementById('searchBox');
            searchBox.addEventListener('input', function(e) {
                const query = e.target.value.toLowerCase();
                const rows = document.querySelectorAll('#tableBody tr');
                
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    if (text.includes(query)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
        }

        // åˆæœŸåŒ–å®Ÿè¡Œ
        init();

        console.log('ğŸš€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èµ·å‹•å®Œäº†');
    </script>
</body>
</html>
